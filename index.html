<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ArcPerps | æœºå¯†æ°¸ç»­åˆçº¦äº¤æ˜“æ¼”ç¤º</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=JetBrains+Mono&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f172a, #1e293b);
            color: #f8fafc;
        }

        .mono { font-family: 'JetBrains+Mono', monospace; }

        .glass-panel {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(51, 65, 85, 0.5);
        }

        .mxe-brain {
            animation: pulse-blue 2s infinite ease-in-out;
        }

        @keyframes pulse-blue {
            0%, 100% { transform: scale(1); opacity: 1; filter: drop-shadow(0 0 5px rgba(59, 130, 246, 0.2)); }
            50% { transform: scale(1.05); opacity: 0.8; filter: drop-shadow(0 0 20px rgba(59, 130, 246, 0.5)); }
        }

        .scanner-line {
            position: absolute;
            left: 0;
            right: 0;
            height: 2px;
            background: #3b82f6;
            box-shadow: 0 0 15px #3b82f6;
            animation: scan 3s infinite linear;
        }

        @keyframes scan {
            0% { top: 0%; opacity: 0; }
            50% { opacity: 1; }
            100% { top: 100%; opacity: 0; }
        }

        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #1e293b; border-radius: 10px; }
        
        input:disabled, select:disabled { 
            opacity: 0.4; 
            cursor: not-allowed;
            background-color: #0f172a !important;
        }
        
        button:disabled { opacity: 0.5; cursor: not-allowed; }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center py-12 px-4">

    <!-- Header -->
    <header class="w-full max-w-6xl flex justify-between items-center mb-12">
        <div class="flex items-center gap-4">
            <div class="bg-blue-600 p-2.5 rounded-2xl shadow-xl shadow-blue-500/20">
                <i class="fas fa-chart-line text-white text-2xl"></i>
            </div>
            <div>
                <h1 class="text-3xl font-black tracking-tighter text-white uppercase italic">ArcPerps</h1>
                <p class="text-sm text-slate-500 uppercase tracking-[0.2em] font-bold">Confidential Risk & PnL Engine</p>
            </div>
        </div>
        <div class="flex flex-col items-end text-right">
            <div class="bg-slate-900 border border-slate-800 px-4 py-2 rounded-full flex items-center gap-2">
                <span class="w-2 h-2 rounded-full bg-blue-500 animate-pulse"></span>
                <span class="text-xs font-black text-slate-300 uppercase tracking-widest">MXE Secure Cluster Active</span>
            </div>
        </div>
    </header>

    <main class="w-full max-w-6xl grid grid-cols-1 lg:grid-cols-12 gap-8 items-stretch">
        <!-- Left: Position Input -->
        <div class="lg:col-span-4 space-y-6">
            <div class="glass-panel rounded-[2.5rem] p-8 space-y-6 shadow-2xl border-t-4 border-blue-500 relative overflow-hidden">
                <div class="absolute -top-20 -left-20 w-40 h-40 bg-blue-500/5 rounded-full blur-3xl"></div>
                
                <h2 class="text-xs font-black text-slate-400 uppercase tracking-widest flex items-center gap-2 relative z-10">
                    <i class="fas fa-user-shield text-blue-500"></i> Open Shielded Position
                </h2>
                
                <div class="space-y-4 relative z-10">
                    <div>
                        <label class="block text-xs text-slate-500 mb-2 uppercase font-black tracking-widest">Entry Price (SOL/USD)</label>
                        <div class="relative">
                            <input type="number" id="entryPrice" value="120.50" class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-4 text-lg focus:border-blue-500 outline-none transition mono text-white">
                            <i class="fas fa-lock absolute right-4 top-1/2 -translate-y-1/2 text-slate-700"></i>
                        </div>
                    </div>

                    <div>
                        <label class="block text-xs text-slate-500 mb-2 uppercase font-black tracking-widest">Leverage (x)</label>
                        <select id="leverage" class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-4 text-sm focus:border-blue-500 outline-none transition font-bold text-white appearance-none">
                            <option value="5">5x (Low Risk)</option>
                            <option value="10" selected>10x (Medium Risk)</option>
                            <option value="20">20x (High Risk)</option>
                            <option value="50">50x (Whale Mode)</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-xs text-slate-500 mb-2 uppercase font-black tracking-widest">Collateral (USDC)</label>
                        <div class="relative">
                            <input type="number" id="collateral" value="1000" class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-4 text-lg focus:border-blue-500 outline-none transition mono text-white">
                            <i class="fas fa-lock absolute right-4 top-1/2 -translate-y-1/2 text-slate-700"></i>
                        </div>
                    </div>

                    <button id="tradeBtn" class="w-full bg-blue-500 text-white font-black py-5 rounded-2xl hover:bg-blue-600 transition active:scale-[0.95] flex items-center justify-center gap-3 mt-4 shadow-xl">
                        <i class="fas fa-bolt" id="btnIcon"></i> <span id="btnText">EXECUTE SHIELDED TRADE</span>
                    </button>
                </div>
            </div>

            <div class="bg-blue-900/10 border border-blue-500/20 p-6 rounded-3xl">
                <p class="text-xs text-slate-400 leading-relaxed italic">
                    "åœ¨ MPC æ¨¡å¼ä¸‹ï¼Œæ‚¨çš„å¼ºå¹³ä»·æ ¼å’Œæœªå®ç°ç›ˆäºä»…åœ¨ Arcium MXE å†…è®¡ç®—ã€‚å¤–éƒ¨è§‚å¯Ÿè€…æ— æ³•é€šè¿‡ç›‘æ§æ‚¨çš„å¥åº·åº¦æ¥é¢„è®¾å–ç›˜ï¼ˆSnipingï¼‰ï¼Œä»è€Œç¡®ä¿å¤§å®—äº¤æ˜“çš„å®‰å…¨ã€‚"
                </p>
            </div>
        </div>

        <!-- Right: Market Dashboard -->
        <div class="lg:col-span-8 flex flex-col gap-6">
            <!-- Market Status Cards -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="glass-panel p-6 rounded-3xl flex flex-col justify-center">
                    <p class="text-xs text-slate-500 uppercase font-black tracking-widest mb-1">Mark Price</p>
                    <div class="flex items-center gap-2">
                        <span class="text-2xl font-black text-white mono" id="markPrice">$120.50</span>
                        <span class="text-xs text-green-500 font-bold"><i class="fas fa-caret-up"></i> LIVE</span>
                    </div>
                </div>
                <div class="glass-panel p-6 rounded-3xl flex flex-col justify-center">
                    <p class="text-xs text-slate-500 uppercase font-black tracking-widest mb-1">Risk Status</p>
                    <span class="text-xs font-black text-green-500 uppercase italic tracking-widest" id="riskStatus">SAFE</span>
                </div>
                <div class="glass-panel p-6 rounded-3xl flex flex-col justify-center">
                    <p class="text-xs text-slate-500 uppercase font-black tracking-widest mb-1">PnL (Confidential)</p>
                    <div class="flex items-center gap-2">
                        <i class="fas fa-eye-slash text-slate-700 text-xs"></i>
                        <span class="text-sm font-bold text-slate-500 mono italic" id="pnlValue">SHIELDED</span>
                    </div>
                </div>
            </div>

            <!-- Visualization Area -->
            <div id="displayPanel" class="glass-panel rounded-[2.5rem] p-10 flex-1 flex flex-col relative overflow-hidden min-h-[450px]">
                <!-- Background Decoration -->
                <div class="absolute inset-0 flex items-center justify-center opacity-[0.03] pointer-events-none">
                    <i class="fas fa-microchip text-[400px] text-blue-500"></i>
                </div>

                <!-- Content Area: Idle -->
                <div id="idleState" class="flex-1 flex flex-col items-center justify-center text-center space-y-6 z-10">
                    <div class="w-32 h-32 rounded-full border-4 border-slate-800 flex items-center justify-center relative">
                        <i class="fas fa-fingerprint text-slate-800 text-5xl animate-pulse"></i>
                    </div>
                    <div class="space-y-2">
                        <h3 class="font-bold text-slate-300 text-lg uppercase tracking-tight">Confidential Trade Dashboard</h3>
                        <p class="text-xs text-slate-600 max-w-sm mx-auto">å¯åŠ¨äº¤æ˜“åï¼ŒArcium å°†åœ¨å¯†æ–‡ç©ºé—´ä¸ºæ‚¨ç»´æŠ¤å¤´å¯¸å¹¶è¿›è¡Œå®æ—¶çš„æ¸…ç®—é£é™©è¯„ä¼°ã€‚</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="mt-16 text-slate-800 text-xs uppercase tracking-[0.5em] font-black italic">
        ArcPerps Confidential Protocol &copy; 2026 | Built on Arcium MXE
    </footer>

    <script>
        const tradeBtn = document.getElementById('tradeBtn');
        const btnText = document.getElementById('btnText');
        const btnIcon = document.getElementById('btnIcon');
        
        // è¾“å…¥æ§ä»¶å¼•ç”¨
        const entryPriceInput = document.getElementById('entryPrice');
        const leverageSelect = document.getElementById('leverage');
        const collateralInput = document.getElementById('collateral');
        
        const idleState = document.getElementById('idleState');
        const computingState = document.getElementById('computingState');
        const statusLog = document.getElementById('statusLog');
        const liveLogs = document.getElementById('liveLogs');
        
        const markPriceEl = document.getElementById('markPrice');
        const riskStatusEl = document.getElementById('riskStatus');
        const pnlValueEl = document.getElementById('pnlValue');

        const phases = [
            "Generating ephemeral x25519 session keys...",
            "Encrypting raw trade intent locally...",
            "Lifting EntryPrice (u64) to SharedEncryptedStruct...",
            "Executing check_perp_liquidation circuit on MXE...",
            "Computing oblivious uPnL: size * (mark - entry)...",
            "Sharding risk proof across Recovery Set (Size 4)...",
            "Finalizing verified callback on Solana Devnet..."
        ];

        function addLiveLog(text, color = 'text-slate-600') {
            const time = new Date().toLocaleTimeString('en-US', { hour12: false });
            const entry = document.createElement('div');
            entry.className = `${color} border-l-2 border-transparent pl-2 hover:border-slate-800 transition-all`;
            entry.innerHTML = `<span class="text-slate-800 mr-2">[${time}]</span> ${text}`;
            liveLogs.prepend(entry);
        }

        // ç»Ÿä¸€é”å®š/è§£é”äº¤äº’çš„è¾…åŠ©å‡½æ•°
        function toggleUIState(isDisabled) {
            tradeBtn.disabled = isDisabled;
            entryPriceInput.disabled = isDisabled;
            leverageSelect.disabled = isDisabled;
            collateralInput.disabled = isDisabled;
        }

        tradeBtn.addEventListener('click', () => {
            const entry = parseFloat(entryPriceInput.value);
            const lev = parseInt(leverageSelect.value);
            const col = parseFloat(collateralInput.value);

            if (isNaN(entry) || isNaN(lev) || isNaN(col) || entry <= 0 || col <= 0) {
                addLiveLog("âš ï¸ [ERROR] Invalid input values. Please check your entry price and collateral.", "text-red-500 font-bold");
                return;
            }

            // Lock all interactions
            toggleUIState(true);
            btnText.innerText = "MPC ENCRYPTING...";
            btnIcon.className = "fas fa-spinner fa-spin";

            idleState.classList.add('hidden');
            computingState.classList.remove('hidden');

            addLiveLog(`ğŸš€ Initiating trade: ${lev}x Position on SOL @ $${entry}`, "text-blue-400 font-bold");

            let phase = 0;
            const logInterval = setInterval(() => {
                if (phase < phases.length) {
                    statusLog.innerText = phases[phase];
                    addLiveLog(`[MXE] ${phases[phase]}`);
                    phase++;
                } else {
                    clearInterval(logInterval);
                }
            }, 700);

            // Simulate trade completion
            setTimeout(() => {
                const mark = entry * (1 + (Math.random() * 0.04 - 0.02));
                markPriceEl.innerText = `$${mark.toFixed(2)}`;
                riskStatusEl.innerText = "VERIFIED SAFE";
                riskStatusEl.className = "text-xs font-black text-green-500 uppercase tracking-widest";
                pnlValueEl.innerText = "SHIELDED";
                pnlValueEl.className = "text-sm font-bold text-slate-500 mono italic";

                addLiveLog("ğŸ‰ [SUCCESS] Position committed to Arcium state. Liquidation Sniping Protections active.", "text-green-500 font-black");

                // Unlock interactions
                toggleUIState(false);
                btnText.innerText = "UPDATE SHIELDED TRADE";
                btnIcon.className = "fas fa-sync-alt";
                computingState.classList.add('hidden');
                idleState.classList.remove('hidden');

                // Additional user feedback
                alert("Trade executed successfully! Your position is now shielded.");
            }, 5500);
        });

        // Background pulses
        setInterval(() => {
            if (tradeBtn.disabled) return;
            const updates = ["Syncing Oracle feed...", "Network Heartbeat: OK", "Verifying state root..."];
            addLiveLog(updates[Math.floor(Math.random()*updates.length)], 'text-slate-800');
        }, 8000);

        addLiveLog("ArcPerps Engine v1.0 Initialized.");
        addLiveLog("Connected to Arcium Cluster 456 (Devnet).");
    </script>
</body>
</html>